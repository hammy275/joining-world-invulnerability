package net.blf02.joiningworldinvulnerability.server;

import net.blf02.joiningworldinvulnerability.JoiningWorldInvulnerability;
import net.minecraft.entity.player.PlayerEntity;
import net.minecraftforge.event.entity.living.LivingHurtEvent;
import net.minecraftforge.event.entity.player.PlayerEvent;
import net.minecraftforge.eventbus.api.SubscribeEvent;

import java.util.HashSet;
import java.util.Set;

public class ServerSubscriber {

    public static Set<PlayerEntity> invulnerablePlayers = new HashSet<>();

    @SubscribeEvent
    public void playerInWorld(PlayerEvent.PlayerLoggedInEvent event) {
        JoiningWorldInvulnerability.LOGGER.info(String.format("Enabled invulnerability for %s", event.getPlayer()));
        invulnerablePlayers.add(event.getPlayer());
    }

    @SubscribeEvent
    public void onPlayerDamageTaken(LivingHurtEvent event) {
        if (event.getEntity() instanceof PlayerEntity && invulnerablePlayers.contains((PlayerEntity) event.getEntity())) {
            event.setCanceled(true);
        }
    }


}
